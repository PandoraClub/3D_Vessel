!function e(t,i,o){function n(r,s){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(a)return a(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var c=i[r]={exports:{}};t[r][0].call(c.exports,function(e){var i=t[r][1][e];return n(i?i:e)},c,c.exports,e,t,i,o)}return i[r].exports}for(var a="function"==typeof require&&require,r=0;r<o.length;r++)n(o[r]);return n}({1:[function(e,t,i){"use strict";var o=e("../core/vessels-3d.js"),n=e("../core/vessels-2d.js"),a=e("../utils/js-helpers.js"),r=e("../utils/dom-utilities.js"),s=e("../colors/colors-widget.js"),l=e("../core/i18labels.js"),d=document.getElementById("app-3d"),c=document.getElementById("titleH1"),u=document.getElementById("titleBay"),h=document.getElementById("info-window"),p=document.getElementById("dropColors"),v=document.getElementById("launchColorsWidget"),m=document.getElementById("btnLaunchPDF"),f=a.getQueryParams(),y,g,b;b={dropFilter:null,dropFilterValue:null,showWireframes:null,currentlyHidden:[],latestFilter:"",dropBays:null,dropBaysDictionary:{},dropAddHouse:null,openBayInfo:null,closeBayInfo:null,bayInfo:null,bayInfoIframe:null,baySelected:"",shipHouseSpace:20.5,isExpanded:!1,prevnextCont:null,prevnextNum:1,numContsByBlock:null,hatchDecksVisible:!0,init:function e(){var t=p,i=document.getElementById("dropFilter"),o=void 0,n=void 0,s=b,l=void 0,d=void 0,c=y.data.filters;s.dropFilterValue=document.getElementById("dropFilterValue"),s.showWireframes=document.getElementById("showWireframesFiltered"),s.expandViewBtn=document.getElementById("expandView"),s.prevnextCont=document.getElementById("prevnext-container"),s.dropFilter=i,s.checkboxHatchCovers=document.getElementById("view-hcs"),s.navBaysNext=document.getElementById("bay-next"),s.navBaysPrev=document.getElementById("bay-prev"),n=document.createElement("option"),n.value="",n.innerHTML="None",i.appendChild(n);var u=[];for(o in c)u.push({name:c[o].name,key:o});for(u=u.sort(function(e,t){return e.name>=t.name?1:-1}),l=0,d=u.length;l<d;l+=1)o=u[l].key,n=document.createElement("option"),n.value=o,n.innerHTML=c[o].name,i.appendChild(n),n=document.createElement("option"),n.value=o,n.innerHTML=c[o].name,t.appendChild(n);t.value="i",r.addEventLnr(i,"change",s.prepareFilter),r.addEventLnr(s.dropFilterValue,"change",s.processFilterValue),r.addEventLnr(t,"change",s.colorize),r.addEventLnr(s.showWireframes,"change",s.listenWireframeDisplay),r.addEventLnr(window,"keydown",s.checkKeyPressed),r.addEventLnr(s.expandViewBtn,"change",s.expandView),r.addEventLnr(s.checkboxHatchCovers,"change",s.toggleHatchCovers),r.addEventLnr(s.navBaysNext,"click",function(){a.callOnCondition(s.isExpanded,s.expandViewNext,s.baysControlNext)}),r.addEventLnr(s.navBaysPrev,"click",function(){a.callOnCondition(s.isExpanded,s.expandViewPrev,s.baysControlPrev)}),s.addBaysControl(),s.addHouseControl(),s.pauseControls(!1)},addBaysControl:function e(){function t(e){var t=e.target.value;v.isolateBay(t)}var i,o,n,s,l=document.getElementById("dropBays"),d=[],c,u,h,p,v=b,m,f=y.renderer3d.g3Bays,g=y.data.dataStructured,E=["<option value=''>All bays</option>"];for(i in f)s=f[i],s.children.length>0&&d.push(s.name.replace("b",""));for(d=d.sort(a.sortNumeric),o=0,n=d.length;o<n;o+=1)m=Number(d[o]),c=m%2===1,c?g[d[o]].n&&(E.push("<option value='"+d[o]+"'>"+d[o]+"</option>"),v.dropBaysDictionary[d[o]]=d[o]):(u=o+1<n&&Number(d[o+1])===m+1,u||v.dropBaysDictionary[a.pad(m-1,3)]||(E.push("<option value='"+a.pad(m,3)+"'>"+a.pad(m-1,3)+"</option>"),v.dropBaysDictionary[a.pad(m-1,3)]=a.pad(m,3)));l.innerHTML=E.join(""),v.dropBays=l,r.addEventLnr(v.dropBays,"change",t),v.openBayInfo=document.getElementById("open-panel"),v.closeBayInfo=document.getElementById("close-panel"),v.bayInfo=document.getElementById("bay-panel"),v.bayInfoIframe=document.getElementById("bay-iframe-container"),r.addEventLnr(v.openBayInfo,"click",v.showBayInfo),r.addEventLnr(v.closeBayInfo,"click",v.showBayInfo),v.openBayInfo.style.left="-300px"},baysControlNext:function e(){var t=b,i=t.dropBays.selectedIndex+1,o=t.dropBays.length;i<o&&(t.dropBays.selectedIndex=i,t.isolateBay(t.dropBays.value)),t.navBaysPrev.className="prevnext bay-prev noselect "+(i>2?"active":""),t.navBaysNext.className="prevnext bay-next noselect "+(i+1>=o?"":"active")},baysControlPrev:function e(){var t=b,i=t.dropBays.selectedIndex-1,o=t.dropBays.length;i>=0&&(t.dropBays.selectedIndex=i,t.isolateBay(t.dropBays.value)),t.navBaysPrev.className="prevnext bay-prev noselect "+(i>2?"active":""),t.navBaysNext.className="prevnext bay-next noselect "+(i+1>=o?"":"active")},addHouseControl:function e(){var t=b,i=document.getElementById("dropAddHouse"),o=y.data.dataStructured,n,s,l,d,c=["<option value=''>No house</option>"];for(s=a.objKeysToArray(t.dropBaysDictionary),s=s.sort(a.sortNumeric),l=s.length-1;l>=0;l-=1)n=s[l],o[n].maxD>20&&c.push("<option value='"+t.dropBaysDictionary[n]+"'>before "+n+"</option>");i.innerHTML=c.join(""),r.addEventLnr(i,"change",t.moveShipHouseLnr),t.dropAddHouse=i},_makeHeightVisible:function e(t){var i=Number(t),o=Math.floor(i),n=1.2*(i-o);return String(o+n).replace(".","'")+'"'},prepareFilter:function e(t){var i=t.target.value,o,n,a=["<option value=''>No filter</option>"],r=b,s=y.data.filters;if(!i)return r.pauseControls(!0),r.showHiddenMeshes(),r.pauseControls(!1),r.dropFilterValue.value="",r.dropFilterValue.innerHTML=a.join(""),void r.dropFilterValue.setAttribute("disabled","disabled");if(r.latestFilter!==i&&(r.pauseControls(!0),r.showHiddenMeshes(),r.pauseControls(!1)),r.latestFilter=i,r.dropFilterValue.removeAttribute("disabled"),r.dropFilterValue.innerHTML="",n=s[i],n.tf)a.push("<option value='1'>yes</option>"),a.push("<option value='0'>no</option>");else{var l=_.keys(n.obs).sort(),d=void 0,c=void 0;for(d=0,c=l.length;d<c;d+=1)a.push("<option value='"+l[d]+"'>"+("h"===i?r._makeHeightVisible(l[d]):l[d])+"</option>")}r.dropFilterValue.innerHTML=a.join("")},processFilterValue:function e(t){var i=t.target.value,o=b,n=o.dropFilter,a,r,s,l=o.showWireframes.checked,d=y.data.filters,c=y.data.allContainerMeshesObj,u=[],h,p;if(o.pauseControls(!0),o.showHiddenMeshes(),""===i)return void o.pauseControls(!1);h=d[o.dropFilter.value].obs;for(s in h)if(o.dropFilterValue.value!==s)for(a=0,r=h[s].indexes.length;a<r;a+=1)p=c[h[s].indexes[a].c],l?(p.isBasic=!0,p.material=y.renderer3d.basicMaterial):p.visible=!1,u.push(h[s].indexes[a].c);o.currentlyHidden=u,o.pauseControls(!1)},processWireframeDisplay:function e(t){var i=b,o=i.currentlyHidden,n,a,r=y.data.allContainerMeshesObj,s=o.length;if(s)for(n=0;n<s;n+=1)a=r[o[n]],t?(a.isBasic=!0,a.material=y.renderer3d.basicMaterial,a.visible=!0):a.visible=!1},listenWireframeDisplay:function e(t){var i=t.target.checked,o=b;o.pauseControls(!0),o.processWireframeDisplay(i),o.pauseControls(!1)},showHiddenMeshes:function e(){var t=b.currentlyHidden,i,o,n=t.length,a=y.data.allContainerMeshesObj;if(n>0)for(i=0;i<n;i+=1)o=a[t[i]],o.isBasic&&(o.material=y.renderer3d.allMaterials[o.materialPos],o.isBasic=!1),o.visible=!0;b.currentlyHidden=[]},pauseControls:function e(t){var i=b,o;return t?(o=i.dropFilterValue.getAttribute("disabled"),i.dropFilter.setAttribute("disabled","disabled"),i.dropFilterValue.setAttribute("disabled","disabled"),i.dropFilterValue.setAttribute("prevAttr",o),i.showWireframes.setAttribute("disabled","disabled"),i.dropBays.setAttribute("disabled","disabled"),void i.dropAddHouse.setAttribute("disabled","disabled")):(o=i.dropFilterValue.getAttribute("prevAttr"),i.dropFilter.removeAttribute("disabled"),"disabled"!==o&&i.dropFilterValue.removeAttribute("disabled"),i.showWireframes.removeAttribute("disabled"),void(i.isExpanded||(i.dropBays.removeAttribute("disabled"),i.baySelected||i.dropAddHouse.removeAttribute("disabled"))))},colorize:function e(t){var i=t.target.value,o,n,a,r,s=y.data.allContainerMeshesObj,l=y.data.filters,d=y.data.data;for(b.showColorsTable(i),o=0,n=d.info.contsL;o<n;o+=1)r=d.conts[o],a=s[r.cDash],a.materialPos=l[i].obs[r[i]].materialPos,a.isBasic||(a.material=y.renderer3d.allMaterials[a.materialPos])},isolateBay:function e(t){function i(e,t,i,o,n){var r,s,l,d,c,u,h;c=e-1,p["b"+a.pad(c,3)]||(c+=2);for(r in p)h=p[r],s=Number(h.name.replace("b","")),s!==e&&s!==c&&(s<e?TweenLite.to(h.position,t,{z:h.originalZ-i,delay:o,ease:Power2.easeInOut}):TweenLite.to(h.position,t,{z:h.originalZ+i,delay:o,ease:Power2.easeInOut}));return y.renderer3d.shipHouse.mesh.visible&&(u=e<v.currPosBay?i:-i,TweenLite.to(v.mesh.position,t,{z:v.currPosZ+u,delay:o,ease:Power2.easeInOut})),l=p["b"+a.pad(e,3)],d=p["b"+a.pad(c,3)],l&&TweenLite.to(l.position,t,{y:n,delay:.5,ease:Power2.easeInOut}),d&&TweenLite.to(d.position,t,{y:n,delay:.5,ease:Power2.easeInOut}),l.originalZ}function o(e){var t,o,n,a,r,u,h,p,v,m,f,g=b,E,w,x,T=y.options,C=y.renderer3d.controls,S=y.renderer3d.camera.position;if(g.pauseControls(!0),g.expandViewBtn.setAttribute("disabled","disabled"),x=""!==g.baySelected,x?(i(Number(g.baySelected),.35,0,0,0),s>0&&(c=i(s,.4,l,.75,d))):c=i(s,1,l,0,d),""!==e){g.baySelected=e,a=c-240,r=d,u=0,h=d-10,f=.5,C.dampingFactor=T.dampingFactorIn,E=30,c+=11,g.checkboxHatchCovers.setAttribute("disabled","disabled"),g.expandViewBtn.setAttribute("disabled","disabled"),y._bayNode.innerHTML="<small>bay</small> "+s,g.prevnextCont.style.display="block";var R=g.dropBays.selectedIndex,_=g.dropBays.length;g.navBaysPrev.className="prevnext bay-prev noselect "+(R>1?"active":""),g.navBaysNext.className="prevnext bay-next noselect "+(R+1===_?"":"active")}else g.baySelected="",a=g.initialCameraPosition.z,r=g.initialCameraPosition.y,u=g.initialCameraPosition.x,h=0,c=g.initialCameraPosition.targetZ,f=0,C.dampingFactor=T.dampingFactorOut,E=-300,g.checkboxHatchCovers.removeAttribute("disabled"),g.prevnextCont.style.display="none";TweenLite.to(S,1,{x:u,y:r,z:a,delay:f,ease:Power2.easeInOut}),TweenLite.to(C.target,2,{y:h,x:0,z:c,ease:Power2.easeInOut}),TweenLite.to(g.openBayInfo,1,{left:E,delay:4*f,ease:Power2.easeInOut}),setTimeout(function(){""===g.baySelected&&g.expandViewBtn.removeAttribute("disabled"),g.pauseControls(!1)},2500)}var n=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],r=b,s=Number(t),l=40,d=500,c,u=y.data.dataStructured,h=y.data.filters,p=y.renderer3d.g3Bays,v=y.renderer3d.shipHouse;o(t?t:""),t?r.dropAddHouse.setAttribute("disabled","disabled"):r.dropAddHouse.removeAttribute("disabled")},showBayInfo:function e(t){var i="open-panel"===t.target.id,o=b,n,a;i?(o.bayInfo.style.display="block",y.pauseRendering(),n=Math.floor(.85*y.height),o.bayInfoIframe.src=(window.bayviewRoute||"")+"?filetoload="+f.filetoload+"&from3d=true&bay="+Number(o.baySelected||0),o.bayInfoIframe.style.height=n+"px"):(o.bayInfo.style.display="none",y.resumeRendering(),o.bayInfoIframe.src="")},tryToLaunchBay:function e(t){var i=b,o=y.data.dataStructured,n,r;if(t&&"n"!==t){if(o[t])return i.dropBays.value=i.dropBaysDictionary[t],void i.isolateBay(t);n=Number(t),r=a.pad(n+1,3),o[r]&&(i.dropBays.value=r,i.isolateBay(r))}},moveShipHouseLnr:function e(t){var i=t.target.value;b.moveShipHouse(i)},moveShipHouse:function e(t){var i,o,n,a=b,r,s,l,d=y.renderer3d.shipHouse,c=y.renderer3d.g3Bays,u=y.renderer3d.hatchCovers,h=a.shipHouseSpace;if(y.pauseRendering(),d.currPosBay>0)for(i in c)o=c[i],n=Number(o.name.replace("b","")),n<d.currPosBay&&(o.position.z+=h,o.originalZ+=h,u[i]&&(u[i].position.z+=h,u[i].originalZ+=h));if(""===t)return d.mesh.visible=!1,void y.resumeRendering();d.currPosBay=Number(t);for(i in c)o=c[i],n=Number(o.name.replace("b","")),n<d.currPosBay&&(o.position.z-=h,o.originalZ-=h,u[i]&&(u[i].position.z-=h,u[i].originalZ-=h));d.mesh.visible=!0,d.mesh.position.z=c["b"+t].position.z-h-.5,d.currPosZ=Number(d.mesh.position.z),y.resumeRendering()},checkKeyPressed:function e(t){var i=b;switch(t.keyCode){case 27:if(i.isExpanded)return;""!==i.baySelected?(i.dropBays.value="",i.bayInfo.style.display="none",y.renderer3d._isRendering=!0,i.isolateBay("")):TweenLite.to(y.renderer3d.camera.position,1,{y:i.initialCameraPosition.y,x:i.initialCameraPosition.x,z:i.initialCameraPosition.z,ease:Power2.easeInOut})}},showColorsTable:function e(t){var i=b,o=document.getElementById("tableColors"),n=[],a,t,r,s,l=y.data.filters,d=l[t],c,u,h;for(r=d.tf,c=r?["1","0"]:_.keys(d.obs).sort(),u=0,h=c.length;u<h;u+=1)a=c[u],s=d.obs[a],r?s&&n.push("<li><span style='background:"+s.color+"'></span>"+("1"===a?"yes":"no")+"</li>"):n.push("<li><span style='background:"+s.color+"'></span>"+("h"===t?i._makeHeightVisible(a):a)+"</li>");o.innerHTML=n.join("")},expandView:function e(t){function i(){if(!r.numContsByBlock){var e={},t=void 0,i=void 0,o=y.data.numContsByBay;for(t=1;t<=w+1;t+=1)i=a.pad(t,3),d=h["b"+i],d&&(e[d.compactBlockNum]||(e[d.compactBlockNum]={n:0}),e[d.compactBlockNum].n+=o[i]||0);r.numContsByBlock=e}}function o(){var e=void 0,t=0;for(r.dropBays.setAttribute("disabled","disabled"),r.dropAddHouse.setAttribute("disabled","disabled"),u=1;u<=w+1;u+=1)c=a.pad(u,3),d=h["b"+c],d&&(e=r.numContsByBlock[d.compactBlockNum],d.isBlockStart&&e.n&&(g-=f,d.labels.visible=!0,t||(t=d.iBay)),d.position.z=1&u&&!d.isBlockStart?22.5+m:0,d.position.x=g,d.position.y=0);r.prevnextNum=1,r.navBaysPrev.className="prevnext bay-prev noselect ",y._bayNode.innerHTML="<small>bay</small> 1",y.renderer3d.simpleDeck.visible=!1,y.renderer3d.hatchDeck.visible=!1,y.renderer3d.shipHouse.prevVisible=y.renderer3d.shipHouse.mesh.visible,y.renderer3d.shipHouse.mesh.visible=!1,y.renderer3d.camera.position.set(0,-2,.8*-f),y.renderer3d.controls.target.set(0,0,20),r.prevnextCont.style.display="block",r._showBaysHatchCovers(r.hatchDecksVisible),r.openBayInfo.style.left="30px",r.baySelected=a.pad(t,3)}function n(){for(c in h)d=h[c],d.position.z=d.originalZ,d.position.x=0,d.position.y=0,d.labels&&(d.labels.visible=!1);var e=b.initialCameraPosition;y.renderer3d.setCameraPosition(e.x,e.y,e.z),y.renderer3d.controls.target.x=0,y.renderer3d.controls.target.y=0,y.renderer3d.controls.target.z=e.targetZ,y.renderer3d.simpleDeck.visible=!0,y.renderer3d.hatchDeck.visible=r.hatchDecksVisible,y.renderer3d.shipHouse.mesh.visible=y.renderer3d.shipHouse.prevVisible,r.prevnextCont.style.display="none",r.pauseControls(!1),r.openBayInfo.style.left="-300px",r.baySelected=""}var r=b,s=t.target.checked,l=void 0,d=void 0,c=void 0,u=void 0,h=y.renderer3d.g3Bays,p=y.data.dataStructured,v=y.renderer3d.maxWidth,m=y.options.extraSep,f=v*(9.5+m)*1.5,g=f,E=!0,w=y.data.lastBay;i(),r.isExpanded=s,y.pauseRendering(),(s?o:n)(),y.resumeRendering()},expandViewNext:function e(){b.expandViewNextPrev(!0)},expandViewPrev:function e(){b.expandViewNextPrev(!1)},expandViewNextPrev:function e(t){function i(){var e=void 0,i=void 0;l=o.prevnextNum;do if(l+=t?1:-1,l<=0||l>y.renderer3d.maxCompactBlockNums)return null;while(o.numContsByBlock[l].n<=0);for(o.navBaysPrev.className="prevnext bay-prev noselect "+(l>1?"active":""),o.navBaysNext.className="prevnext bay-next noselect "+(l===y.renderer3d.maxCompactBlockNums?"":"active"),i=1;i<=c+1;i+=1)if(r=a.pad(i,3),e=d["b"+r],e&&e.compactBlockNum===l&&o.numContsByBlock[e.compactBlockNum].n)return e;return null}var o=b,n=.5,r=void 0,s=void 0,l=void 0,d=y.renderer3d.g3Bays,c=y.data.lastBay,u=function e(t,i){return t?i:!i};s=i(),s&&(TweenLite.to(y.renderer3d.camera.position,n,{x:s.position.x,ease:Power2.easeInOut}),TweenLite.to(y.renderer3d.controls.target,n,{x:s.position.x,ease:Power2.easeInOut}),y._bayNode.innerHTML="<small>bay</small> "+s.iBay,o.baySelected=a.pad(s.iBay,3),o.prevnextNum=l)},toggleHatchCovers:function e(t){var i=b,o=t.target.checked,n=y.renderer3d.hatchDeck;i.hatchDecksVisible=o,i.isExpanded?(n.visible=!1,i._showBaysHatchCovers(o)):(n.visible=o,i._showBaysHatchCovers(!1))},_showBaysHatchCovers:function e(t){var i=void 0,o=void 0,n=y.renderer3d.g3Bays;for(i in n)o=n[i],o.isBlockStart&&o.hatchC&&(o.hatchC.visible=t)},disableRendering:function e(t){y.toggleRendering(!t),y.renderer3d.controls.enabled=!t},updateSceneAfterCustomColors:function e(t,i,o){function n(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}var a=void 0,r=void 0,s=void 0,l=void 0,d=void 0;y.data.filters=t;for(a in i)r=a.split("___"),2===r.length&&(l=t[r[0]].obs[r[1]],d=y.renderer3d.allMaterials[l.materialPos],s=n(l.color),d.color.setRGB(s.r/255,s.g/255,s.b/255),d.needsUpdate=!0);b.showColorsTable(p.value)}},y=new o.VesselsApp3D(d,c,h,u),y.loadUrl(f.json,l.LOADING_DATA).then(function(e){var t=y.renderer3d,i=void 0,o=y.modelsFactory,a=void 0,r=void 0,l=void 0;y.updateHtmlTitle(e.VesselName,e.PlaceOfDeparture,e.VoyageNumber),a=y.loadData(e),y.data=a;for(var d=0,c=y.data.data.info.contsL;d<c;d+=1){var u=y.data.data.conts[d];t.createBay(u.bay),o.addIsoModel(u)}o.extendSpecs(y.data.filters),i=new s.ColorsWidget(v,y.data.filters,p),i.onToggled=b.disableRendering,i.onSaved=b.updateSceneAfterCustomColors,i.postUrl=window.writeColorsRoute,window.userSettings&&i.mergeColorSettings(window.userSettings),o.createBaseMaterials(y.data.filters),t.createBaseModels(o.isoModels),t.create3dContainersFromData(y.data),y.data.data.conts[0]&&t.putInfoWindow(y.data.data.conts[0]),b.init(),b.showColorsTable("i"),b.tryToLaunchBay(y.initialBay),r=t.maxDepth,l=Math.round(r/2),b.initialCameraPosition=t.setCameraPosition(-Math.round(.75*r),350,Math.round(.5*r)),t.controls.maxDistance=1.5*r,t.controls.target.z=l,b.initialCameraPosition.targetZ=l,g=new n.VesselsApp2D(m),g.data=a,g.applyColorsFilter(g.data.filters),g.setTitle(e.VesselName,e.PlaceOfDeparture,e.VoyageNumber),g.setMetaData(e.VesselName,e.VesselCallSign,e.Sender,e.Recipient,e.PlaceOfDeparture,e.VoyageNumber,e.FooterLeft,e.FooterRight),g.postUrl=window.generatePdfRoute,g.baseUrl=window.generatePdfBaseUrlRoute||"",g.baseDownloadUrl=window.downloadPdfBaseUrlRoute||"",g.onToggled=b.disableRendering,window.appVessels2D=g},function(e){y._node.loadingDiv.setMessage(e,!0),y._node.loadingDiv.updateLoader(0,1)}),window.appVessels3D=y},{"../colors/colors-widget.js":2,"../core/i18labels.js":4,"../core/vessels-2d.js":7,"../core/vessels-3d.js":8,"../utils/dom-utilities.js":12,"../utils/js-helpers.js":13}],2:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=e("../utils/js-helpers.js"),r=e("../utils/dom-utilities.js"),s=e("../core/i18labels.js"),l=function(){function e(t,i){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];o(this,e);var a=this;this.isOpened=!1,this.btn=t,this.referenz=n,this.filters=i||{},this._currentOption=null,this._node=function(){var e=void 0,o=void 0,n=void 0,l=void 0,d=void 0,c=void 0,u=void 0,h=void 0,p=void 0,v=[],m=void 0,f=void 0,y=void 0,g=void 0,b=void 0,E="colors-container-"+Math.round(1e5*Math.random());e=document.createElement("div"),e.className="colors-container",e.innerHTML="<h2>"+s.CLICK_TO_CHANGE_COLORS+"</h2>",e.id=E,m=document.createElement("div"),m.className="colors-container-top",o=document.createElement("SELECT"),o.id=E+"-dropdwn",m.appendChild(o),y=[];for(h in i)y.push({name:i[h].name,key:h});for(y=y.sort(function(e,t){return e.name>=t.name?1:-1}),g=0,b=y.length;g<b;g+=1)h=y[g].key,p=i[h],v.push("<option value='"+h+"'>"+p.name+"</option>");return o.innerHTML=v.join(""),l=document.createElement("button"),l.innerHTML="SAVE",m.appendChild(l),d=document.createElement("button"),d.innerHTML="CANCEL",m.appendChild(d),e.appendChild(m),n=document.createElement("ul"),n.className="colors-container-ulColors",n.id=E+"-ulColors",e.appendChild(n),c=document.createElement("div"),c.className="colors-container-colorPicker",c.id=E+"-colorPicker",e.appendChild(c),e.dropdwn=o,e.ulColors=n,e.colorPickerDiv=c,e.btnSave=l,e.btnCancel=d,e.colorsTemp={},document.body.appendChild(e),t&&(r.addEventLnr(t,"click",a.toggleHandler.bind(a)),r.addEventLnr(o,"change",a.dropFilterChanged.bind(a)),r.addEventLnr(d,"click",a.close.bind(a)),r.addEventLnr(l,"click",a.saveColors.bind(a)),r.addEventLnr(n,"click",a.selectOption.bind(a))),e}(),this.onToggled=null,this.onSaved=null,this.postUrl=null,this._jsonColors={}}return n(e,[{key:"mergeColorSettings",value:function e(t){var i=t,o=void 0,n=void 0,a=void 0,r=this.filters,l=void 0,d=void 0;if("String"==typeof t&&(i=JSON.parse(t)),!i.colors)return void console.warn(s.NO_COLOR_SETTINGS);for(o in i.colors)l=o.split("___"),r[l[0]]&&r[l[0]].obs.hasOwnProperty(l[1])&&(n=i.colors[o],r[l[0]].obs[l[1]].color=n,r[l[0]].obs[l[1]].hexColor=parseInt(n.replace(/^#/,""),16),r[l[0]].obs[l[1]].colorIsRandom=!1);this._jsonColors=i.colors}},{key:"toggleHandler",value:function e(t){this.toggle(!this.isOpened)}},{key:"close",value:function e(){this.toggle(!1)}},{key:"toggle",value:function e(){var t=arguments.length<=0||void 0===arguments[0]||arguments[0],i=this.filters;return this._node.style.display=t?"block":"none",this.isOpened=t,t?(this._node.colorsTemp={},this.referenz&&""!==this.referenz.value&&i[this.referenz.value]&&(this._node.dropdwn.value=this.referenz.value),this.dropFilterChanged(),void(this.onToggled&&this.onToggled(!0))):void(this.onToggled&&this.onToggled(!1))}},{key:"_makeHeightVisible",value:function e(t){var i=Number(t),o=Math.floor(i),n=1.2*(i-o);return String(o+n).replace(".","'")+'"'}},{key:"dropFilterChanged",value:function e(){var t=this,i=[],o=void 0,n={0:"no",1:"yes"},a=this._node.dropdwn.value,r=this.filters[a],s=void 0,l=void 0,d=void 0,c=void 0,u=void 0,h=void 0,p=void 0;for(u=_.keys(r.obs).sort(),h=0,p=u.length;h<p;h+=1)o=u[h],d=t._node.colorsTemp[a+"___"+o]||r.obs[o].color,c="h"===a?t._makeHeightVisible(o):o,i.push("<li class='"+(r.obs[o].colorIsRandom?"":"customized")+"' data-color='"+d+"' id='liColor_"+a+"___"+o+"'><span style='background:"+d+"'> </span>"+(r.tf?n[o]:c)+"&nbsp;</li>");this._node.ulColors.innerHTML=i.join(""),s=this._node.ulColors.getElementsByTagName("LI"),s&&0!==s.length&&(l=s[0],l.className+=" selected",this._currentOption=l,this._node.colorPickerJoe?this._node.colorPickerJoe.set(l.getAttribute("data-color")):(this._node.colorPickerJoe=colorjoe.rgb(this._node.colorPickerDiv,l.getAttribute("data-color"),["hex"]),this._node.colorPickerJoe.on("change",function(e){var i=t._currentOption.id.replace("liColor_",""),o=t._currentOption.getAttribute("data-color"),n=e.hex();t._currentOption.setAttribute("data-color",n),t._currentOption.getElementsByTagName("SPAN")[0].style.background=n,t._node.colorsTemp[i]=n,o!==n&&t._currentOption.className.indexOf("customized")<0&&(t._currentOption.className+=" customized")})))}},{key:"selectOption",value:function e(t){var i=this,o=t.target,n=void 0,a=void 0,r=void 0;if("LI"===o.tagName&&(n=this._node.ulColors.getElementsByTagName("LI"),!(o.className.indexOf("selected")>=0))){for(a=0,r=n.length;a<r;a+=1)o!==n[a]&&(n[a].className=n[a].className.replace("selected",""));setTimeout(function(){var e=o.getAttribute("data-color");o.className+=" selected",i._node.colorPickerJoe.set(e,!0),i._currentOption=o,setTimeout(function(){var t=i._node.colorPickerJoe.e.getElementsByTagName("INPUT");t&&t.length>0&&(t[0].value=e)},150)},150)}}},{key:"saveColors",value:function e(){var t=void 0,i=this._node.colorsTemp,o=this.filters,n={},a=[],r=void 0,s=void 0,l=void 0;for(t in i)r=t.split("___"),2===r.length&&(s=i[t],o[r[0]].obs[r[1]].color=s,o[r[0]].obs[r[1]].hexColor=parseInt(s.replace(/^#/,""),16),o[r[0]].obs[r[1]].colorIsRandom=!1,n[r[0]]||(n[r[0]]=!0),a.push({attributeKey:r[0],attributeValue:r[1],hexColor:s}));this.close(),this.onSaved&&this.onSaved(o,i,n),this.postUrl&&0!==a.length&&(l=new XMLHttpRequest,l.open("POST",this.postUrl),l.setRequestHeader("Content-Type","application/json"),l.onreadystatechange=function(){4===l.readyState&&200===l.status&&console.log(l.responseText)},l.send(JSON.stringify(a)))}},{key:"getColors",value:function e(){var t={},i=void 0,o=void 0,n=this.filters;for(i in n){t[i]={};for(o in n[i].obs)t[i][o]={color:n[i].obs[o].color,colorIsRandom:n[i].obs[o].colorIsRandom}}return t}}]),e}();i.ColorsWidget=l},{"../core/i18labels.js":4,"../utils/dom-utilities.js":12,"../utils/js-helpers.js":13}],3:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=e("./i18labels.js"),r=e("../utils/js-helpers.js"),s=e("../utils/dom-utilities.js"),l=function(){function e(t){o(this,e),this.divLoading=t}return n(e,[{key:"loadUrl",value:function e(t){var i=arguments.length<=1||void 0===arguments[1]?"":arguments[1],o=arguments.length<=2||void 0===arguments[2]?null:arguments[2],n=this;return new Promise(function(e,r){function l(t){var i=void 0;try{200===d.status?(i=JSON.parse(d.responseText),e(i)):r(d.statusText)}catch(e){r(a.ERROR_PARSING_JSON+" "+e.description)}}var d=void 0,c=function e(t){n.divLoading&&(n.divLoading.setMessage(t.responseText,!0),n.divLoading.updateLoader(0,1)),console.error(t)},u=function e(t){if(t.lengthComputable){var i=t.loaded/t.total;n.divLoading.updateLoader(i,.5)}};return t?(n.divLoading&&(n.divLoading.show(),n.divLoading.startAnimation(),i&&n.divLoading.setMessage(i)),d=new XMLHttpRequest,s.addEventLnr(d,"load",l),s.addEventLnr(d,"error",c),(n.divLoading||null!==o)&&s.addEventLnr(d,"progress",o||u),d.open("GET",t+(t.indexOf("?")>0?"&":"?")+"t="+1*new Date),void d.send()):void r(a.INVALID_DATA_SOURCE)})}},{key:"generateStructuredData",value:function e(t){function i(e){var t=e.bay,i=e.iBay;i%2===0&&(t=r.pad(i-1,3)),O[e.bay]?O[e.bay]+=1:O[e.bay]=1,x[t]||(x[t]={cells:{},n:0},x.n+=1,x[t].maxD=20,C.push(t)),x[t].cells[e.cell]||(x[t].cells[e.cell]={tiers:{},n:0},x[t].n+=1,D||"00"!==e.cell||(D=!0)),x[t].cells[e.cell].tiers[e.tier]=e,x[t].cells[e.cell].n+=1,B<x[t].n&&(B=x[t].n),e.depth>x[t].maxD&&(x[t].maxD=e.depth),l.tier<"78"?(g.tiers[l.tier]||(g.tiers[l.tier]={h:e.h,accH:0},g.n+=1),e.h>g.tiers[l.tier].h&&(g.tiers[l.tier].h=e.h)):b.tiers[l.tier]||(b.tiers[l.tier]={h:e.h,accH:0},b.n+=1),y[l.tier]?y[l.tier].maxH=Math.max(y[l.tier].maxH,l.h):y[l.tier]={maxH:l.h}}function o(e,t,i){T[e]={name:t,obs:{},tf:i}}function n(e){T.s.obs[e.s]||(T.s.obs[e.s]={c:1,indexes:[]}),T.i.obs[e.i]||(T.i.obs[e.i]={c:1,indexes:[]}),T.r.obs[e.r]||(T.r.obs[e.r]={c:1,indexes:[]}),T.w.obs[e.w]||(T.w.obs[e.w]={c:1,indexes:[]}),T.o.obs[e.o]||(T.o.obs[e.o]={c:1,indexes:[]}),T.d.obs[e.d]||(T.d.obs[e.d]={c:1,indexes:[]}),T.f.obs[e.f]||(T.f.obs[e.f]={c:1,indexes:[]}),T.t.obs[e.t]||(T.t.obs[e.t]={c:1,indexes:[]}),T.x.obs[e.x]||(T.x.obs[e.x]={c:1,indexes:[]}),T.v.obs[e.v]||(T.v.obs[e.v]={c:1,indexes:[]}),T.l.obs[e.l]||(T.l.obs[e.l]={c:1,indexes:[]}),T.h.obs[e.h]||(T.h.obs[e.h]={c:1,indexes:[]}),T.s.obs[e.s].indexes.push(e),T.i.obs[e.i].indexes.push(e),T.r.obs[e.r].indexes.push(e),T.w.obs[e.w].indexes.push(e),T.o.obs[e.o].indexes.push(e),T.d.obs[e.d].indexes.push(e),T.f.obs[e.f].indexes.push(e),T.t.obs[e.t].indexes.push(e),T.x.obs[e.x].indexes.push(e),T.v.obs[e.v].indexes.push(e),T.l.obs[e.l].indexes.push(e),T.h.obs[e.h].indexes.push(e)}var a=void 0,s=void 0,l=void 0,d=void 0,c=void 0,u=void 0,h=0,p=0,v=0,m={},f={},y={},g=void 0,b=void 0,E=void 0,w=void 0,x=void 0,T=void 0,C=[],S=void 0,R=void 0,P=void 0,M=void 0,k=void 0,N=void 0,H=void 0,B=0,L="",D=!1,I=0,O={},j={},A={};if(w=t["3DVesselData"]||t["2DVesselData"],!w)return console.error("No data!. Halting generateStructuredData."),null;for(E={conts:w,info:{contsL:w.length}},x={n:0},g={n:0,tiers:{}},b={n:0,tiers:{}},T={},o("i","Equipment Type",!1),o("s","Is Full",!0),o("r","Is Reefer",!0),o("w","Is Hazardous",!0),o("t","Is Tank",!0),o("x","Is OOG",!0),o("o","Line Operator",!1),o("d","Port of Discharge",!1),o("f","Port of Load",!1),o("v","Is VGM Weight",!0),o("l","Length",!1),o("h","Height",!1),s=0,a=E.conts.length;s<a;s+=1)l=E.conts[s],l.bay=l.p.substr(0,3),l.cell=l.p.substr(3,2),l.tier=l.p.substr(5,2),l.h=Number(Math.floor(l.h))+5*(l.h-Math.floor(l.h))/6,l.depth=Number(Math.floor(l.l))+5*(l.l-Math.floor(l.l))/6,l.iBay=Number(l.bay),l.iTier=Number(l.tier),l.myJ=s,l.cDash=l.c.replace(/\s/gi,"-"),void 0===l.f&&void 0!==l.ld&&(l.f=l.ld),j["cont_"+l.cDash]=l,i(l),n(l);for(L=_.max(_.keys(x)),s=1,a=Number(L);s<=a;s+=2)S=r.pad(s,3),P=r.pad(s-1,3),x[S]&&(x[S].isBlockStart=!0,O[P]&&(x[S].isBlockStart=!1),x[S].maxCell=_.chain(x[S].cells).keys().sort().last().value());return M=Number(_.min(_.keys(g.tiers))),k=Number(_.min(_.keys(b.tiers))),N=Number(_.max(_.keys(g.tiers))),H=Number(_.max(_.keys(b.tiers))),{data:E,dataStructured:x,dataStructuredKeysArr:C.sort(r.sortNumeric),belowTiers:g,aboveTiers:b,containersIDs:j,numContsByBay:O,allContainerMeshesObj:A,filters:T,iTierMin:M,iTierMinAbove:k,iTierMax:N,iTierMaxAbove:H,tiers:y,maxWidth:B,firstBay:_.min(_.keys(x)),lastBay:L,hasZeroCell:D}}}]),e}();i.DataLoader=l},{"../utils/dom-utilities.js":12,"../utils/js-helpers.js":13,"./i18labels.js":4}],4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o="Loading 3D Model...";i.LOADING_DATA=o;var n="Error: Missing data source.";i.INVALID_DATA_SOURCE=n;var a="Error while parsing the JSON file.";i.ERROR_PARSING_JSON=a;var r="Click on colors to change them. <br /><em>A black dot means there is already a custom colour being used.</em>";i.CLICK_TO_CHANGE_COLORS=r;var s="No color settings found. Will use random.";i.NO_COLOR_SETTINGS=s;var l="Please select the document options";i.PRINTOPTS_TITLE=l;var d="Orientation";i.PRINTOPTS_ORIENTATION=d;var c="Landscape";i.PRINTOPTS_ORIENTATION_LANDSCAPE=c;var u="Portrait";i.PRINTOPTS_ORIENTATION_PORTRAIT=u;var h="Printer DPI";i.PRINTOPTS_DPI=h;var p="Paper Size";i.PRINTOPTS_SIZE=p;var v="GENERATE PDF";i.PRINTOPTS_GO=v;var m="Bays per row";i.PRINTOPTS_PERROW=m;var f="Colour by";i.PRINTOPTS_COLORBY=f;var y="Generating pages, please wait...";i.PRINTOPTS_PAGEPROGRESS=y;var g="Sending pages, please wait...";i.PRINTOPTS_SENDINGPAGES=g;var b="Download PDF";i.PRINTOPTS_DOWNLOAD=b},{}],5:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=e("../utils/random-color.js"),r=function(){function e(t){o(this,e),this.models={},this.isoModels={},this.appScene=t}return n(e,[{key:"addIsoModel",value:function e(t){var i=this,o=i.isoModels;o[t.i]||(o[t.i]={d:t.depth,h:t.h,t:t.t})}},{key:"extendSpecs",value:function e(t){var i,o,n,r,s,l,d=this,c=new a.RColor,u,h;for(n in t){s=t[n];for(r in s.obs)l=s.obs[r],u=c.get(!0),h=parseInt(u.replace(/^#/,""),16),l.color=u,l.hexColor=h,l.colorIsRandom=!0}}},{key:"createBaseMaterials",value:function e(t){var i,o,n,a,r,s,l=this,d,c,u,h=this.appScene.renderer3d;for(n in t){r=t[n];for(a in r.obs)s=r.obs[a],u=s.hexColor,c=h.addContainerMaterial(u),s.materialPos=c}}}]),e}();i.ModelsFactory=r},{"../utils/random-color.js":15}],6:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=e("../utils/js-helpers.js"),r=e("../utils/dom-utilities.js"),s=e("../text2D/SpriteText2D.js"),l=e("../text2D/textAlign.js"),d=function(){
function e(t,i,n){o(this,e),this.scene=null,this.renderer=null,this.camera=null,this.raycaster=new THREE.Raycaster,this.mouseVector=new THREE.Vector2,this.controls=null,this.appScene=t,this.container=t._node,this.width=i,this.height=n,this.frames=0,this._INTERSECTED=null,this.followMouseEvents=!1,this.mouseStart=new THREE.Vector2,this.mouseLastClick=new Date,this._isRendering=!0,this._floatingCamera=!0,this._modelsLoaded={},this.g3Bays={},this.models={},this.maxDepth=0,this.maxWidth=0,this.shipHouse=null,this.simpleDeck=null,this.hatchCover=null,this.hatchCovers={},this.allMaterials=[],this.basicMaterial=new THREE.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.3,wireframe:!0}),this.selectionMaterial=new THREE.MeshStandardMaterial({color:0,side:THREE.DoubleSide,opacity:1,transparent:!1}),this.containersGroup=null}return n(e,[{key:"init",value:function e(){function t(e,t,i){var o=new THREE.DirectionalLight(16777215,.3);return o.position.set(e,t,i),o.castShadow=!0,o.shadow.camera.left=-l,o.shadow.camera.right=l,o.shadow.camera.top=l,o.shadow.camera.bottom=-l,o.shadow.camera.far=1600,o.shadow.camera.near=1,o}var i=this,o=void 0,n=void 0,a=void 0,s=void 0,l=800,d=this.appScene.options;if(null===this.container||void 0===this.container)return void console.error("Container is null. Halting.");if(!this.width)return void console.error("Width is null or zero. Halting.");if(!this.height)return void console.error("Height is null or zero. Halting.");this.scene=new THREE.Scene,this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setClearColor(d.colors.background,1),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.container.divRenderC.appendChild(this.renderer.domElement),this.camera=new THREE.PerspectiveCamera(50,this.width/this.height,1,3e4),this.camera.position.z=d.initialCameraPosition.z,this.camera.position.x=d.initialCameraPosition.x,this.camera.position.y=d.initialCameraPosition.y,this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=d.dampingFactorOut||.2,this.controls.minPolarAngle=Math.PI/5,this.controls.maxPolarAngle=Math.PI/5*4,this.controls.maxDistance=2*d.initialCameraPosition.z,this.controls.minDistance=d.initialCameraPosition.z/2,this.controls.enableKeys=!1,this.controls.enablePan=!1,this.raycaster=new THREE.Raycaster,this.mouseVector=new THREE.Vector2,a=new THREE.Group,n=t(-l,l,-l),a.add(n),n=t(l,l,-l),a.add(n),n=t(l,l,l),a.add(n),n=t(-l,l,l),a.add(n),n=new THREE.DirectionalLight(16316398,.15),n.position.set(0,-300,-50),a.add(n),this.lightsGroup=a,n=new THREE.AmbientLight(d.colors.sunlight,.7),this.scene.add(n),this.scene.add(a);var c=new THREE.Object3D;this.scene.add(c),this.containersGroup=c,r.addEventLnr(window,"mousemove",function(e){i.mouseVector.x=e.clientX/i.width*2-1,i.mouseVector.y=2*-(e.clientY/i.height)+1})}},{key:"createBay",value:function e(t){var i=this,o=void 0,n=void 0,a=void 0;return i.g3Bays["b"+t]?i.g3Bays["b"+t]:(o=new THREE.Group,o.name="b"+t,o.iBay=Number(t),o.isBlockStart=!1,i.g3Bays["b"+t]=o,i.containersGroup.add(o),o)}},{key:"_addLabelsToBay",value:function e(t,i,o){var n=arguments.length<=3||void 0===arguments[3]?"FWD":arguments[3],a=arguments.length<=4||void 0===arguments[4]?"AFT":arguments[4],r=void 0,d=this.appScene.data.aboveTiers.n,c=this.appScene.options.extraSep,u=this.appScene.options.labelScale||2;r=new THREE.Group,r.name="labels",r.visible=!1,t.labelsCanBeVisible=!0;var h=new s(n,{align:l.center,font:"32px Arial",fillStyle:"#888888"});h.position.z=-15,h.scale.set(u,u,1),r.add(h),h=new s(a,{align:l.center,font:"32px Arial",fillStyle:"#888888"}),h.position.z=60,h.scale.set(u,u,1),r.add(h),t.add(r),t.labels=r,r.position.y=i,r.position.z=o}},{key:"addContainerMaterial",value:function e(t){var i=new THREE.MeshStandardMaterial({color:t,side:THREE.DoubleSide,transparent:!0,opacity:1});return this.allMaterials.push(i),this.allMaterials.length-1}},{key:"createBaseModels",value:function e(t){var i=this,o,n,a,r,s,l,d=this.appScene.data.filters,c,u;for(o in t)n=t[o],a=n.h,s=d.i.obs[o],n.t?(c=new THREE.CylinderGeometry(4,4,n.d,16),u=new THREE.Mesh(c,i.allMaterials[s.materialPos]),c.translate(-4,n.d/2,-4),u.rotation.z=-Math.PI/2,u.rotation.y=-Math.PI/2):(r=new THREE.Shape([new THREE.Vector2(0,0),new THREE.Vector2(0,a),new THREE.Vector2(8,a),new THREE.Vector2(8,0)]),c=new THREE.ExtrudeGeometry(r,{bevelEnabled:!1,steps:1,amount:n.d}),u=new THREE.Mesh(c,i.allMaterials[s.materialPos])),u.materialPos=s.materialPos,u.dynamic=!0,this.models[o]=u}},{key:"create3dContainersFromData",value:function e(t){var i=this,o=t.data,n=t.belowTiers,r=t.aboveTiers,s=t.iTierMin,l=t.iTierMinAbove,d=t.dataStructured,c=t.allContainerMeshesObj,u=t.numContsByBay,h=this.g3Bays,p=this.appScene._node.loadingDiv,v=this.appScene.options.extraSep,m=void 0,f=o.info.contsL,y=void 0,g=void 0,b=void 0,E=void 0,w=void 0,x=void 0,T=void 0,C=void 0,S=void 0,R=void 0,P=void 0,M=void 0,k=void 0,N=0,H=void 0,B=void 0,L=void 0,D=void 0,I=void 0,O=void 0,j=void 0,A=4,F=4-v,V=void 0,z=void 0,U=void 0,W=void 0,G=void 0,Z=void 0,J=void 0,K=[],q=void 0,Q=void 0,Y=void 0,X=void 0,ee={},te=new THREE.MeshStandardMaterial({color:6710886}),ie=function e(t,i){t.p===i.p?0:t.p<i.p?-1:1};for(V=_.max(_.keys(d)),G=d[V].maxD,F=_.reduce(n.tiers,function(e,t){return e+t.h+v},0)+F,q=0,m=1;m<=V;m+=2)g=a.pad(m,3),Q=a.pad(m+1,3),Y=a.pad(m-1,3),X=h["b"+Q],d[g]||(d[g]={cells:{},n:0,z:0}),m%2===1&&(N+=22.5+v),d[g].z=N,Z=i.createBay(g),Z.position.z=N,Z.originalZ=N,Z.isBlockStart=!0,X&&(X.position.z=N,X.originalZ=N),u[Y]&&(Z.isBlockStart=!1),Z.isBlockStart&&(q+=1,this._addLabelsToBay(Z,r.n*(9.5+v),0)),Z.compactBlockNum=q,X&&(X.compactBlockNum=q);for(J=N+G,this.maxDepth=J,this.maxWidth=t.maxWidth,this.maxCompactBlockNums=q,m=0,f=o.info.contsL;m<f;m+=1)C=o.conts[m],S=i.models[String(C.i)],z=C.iBay,U=Number(C.cell),H=(U%2===0?U/2:-(U+1)/2)*(8+v),W=Number(C.tier),B=W>=78?(W-l)/2*(9.5+v)+A:(W-s)/2*(9.5+v)-F,R=S.clone(),R.materialPos=S.materialPos,R.name="cont_"+C.cDash,R.objRef=C,R.position.x=H,R.position.y=B,R.position.z=0,R.updateMatrix(),R.matrixAutoUpdate=!1,R.isBasic=!1,h["b"+C.bay].add(R),c[C.cDash]=R;i._createShipDeck(),i._createHouse(r.n),i._createHatchCovers(),p.stopAnimation(),setTimeout(function(){p.hide()},500)}},{key:"_createHatchCovers",value:function e(){function t(e){var t=void 0,i=void 0,o=void 0,n=void 0,a=void 0;if(0===e)return[1];o=5===e||6===e||9===e?3:e<=4?e:4,t=e/o,i=Math.ceil(t),a=new Array(i);for(var r=0;r<i;r+=1)a[r]=o;return n=Math.ceil((t-Math.floor(t))*o),n>0&&(a[Math.floor(i/2)]=n),a}function i(e,t){var i=void 0,n=void 0,a=void 0,r=e*(8+o)-o;return i=new THREE.Shape([new THREE.Vector2(-r,0),new THREE.Vector2(-r,t),new THREE.Vector2(0,t),new THREE.Vector2(0,0)]),n=new THREE.ExtrudeGeometry(i,{bevelEnabled:!1,steps:1,amount:3}),a=new THREE.Mesh(n,H),a.rotation.x=Math.PI/2,n.translate(8.5+o,0,0),a}var o=this.appScene.options.extraSep,n=this.maxWidth,r=this.maxDepth,s=n*(8+o),l=this.appScene.data.dataStructured,d=this.g3Bays,c=this.appScene.data.lastBay,u=this.appScene.data.hasZeroCell?1:0,h=[],p=void 0,v=void 0,m=void 0,f=void 0,y=void 0,g=[],b=void 0,E=0,w=void 0,x=new THREE.Group,T=void 0,C=void 0,S=void 0,R=void 0,P=void 0,M=void 0,k=void 0,N=void 0,H=new THREE.MeshStandardMaterial({color:6710886}),B=45,L=function e(t){return(t%2===0?t/2:-(t+1)/2)*(8+o)};for(p=1;p<=c+1;p+=2)m=a.pad(p,3),f=d["b"+m],f&&(y=Number(f.compactBlockNum),g[y]?(g[y].posLeft=l[m].n?Math.max(g[y].posLeft,Number(_.max(_.filter(_(l[m].cells).keys(),function(e){return Number(e)%2===0}),function(e){return Number(e)}))):0,g[y].posRight=l[m].n?Math.max(g[y].posRight,Number(_.max(_.filter(_(l[m].cells).keys(),function(e){return Number(e)%2===1}),function(e){return Number(e)}))):0):g[y]={baseBay:f.iBay,cbn:y,cells:l[m].n,maxD:l[m].maxD||0,posLeft:l[m].n?Number(_.max(_.filter(_(l[m].cells).keys(),function(e){return Number(e)%2===0}),function(e){return Number(e)})):0,posRight:l[m].n?Number(_.max(_.filter(_(l[m].cells).keys(),function(e){return Number(e)%2===1}),function(e){return Number(e)})):0},E=y);for(g[1].maxLeftUp=g[1].posLeft,g[1].maxRightUp=g[1].posRight,g[E].maxLeftDown=g[E].posLeft,g[E].maxRightDown=g[E].posRight,p=2,v=E+1;p<v;p+=1)g[p].maxLeftUp=Math.max(g[p-1].maxLeftUp,g[p].posLeft),g[p].maxRightUp=Math.max(g[p-1].maxRightUp,g[p].posRight),g[v-p].maxLeftDown=Math.max(g[v-p+1].maxLeftDown,g[v-p].posLeft),g[v-p].maxRightDown=Math.max(g[v-p+1].maxRightDown,g[v-p].posRight);for(p=1,v=E+1;p<v;p+=1)g[p].maxLeft=Number(Math.min(g[p].maxLeftUp,g[p].maxLeftDown)),g[p].maxRight=Number(Math.min(g[p].maxRightUp,g[p].maxRightDown)),w=Math.max(g[p].maxLeft,g[p].maxRight),k=g[p].maxD?g[p].maxD<=20?22.5:45:22.5,0!==k&&(1===p?h.push({d:k,l:g[p].maxLeft,b:g[p].baseBay,hts:t(w+u)}):g[p].maxLeft===g[p-1].maxLeft&&g[p].maxRight===g[p-1].maxRight&&h[h.length-1].d+(g[p].maxD||45)<=B?h[h.length-1].d+=g[p].maxD||45:h.push({d:k,l:g[p].maxLeft,b:g[p].baseBay,hts:t(w+u)}));for(M=22.5,p=0,v=h.length;p<v;p+=1){C=h[p],N=new THREE.Group,N.name="baseBay-"+C.b,N.baseBay=C.b,this.hatchCovers["b"+a.pad(C.b,3)]=N,R=C.l,P=L(R);for(var D=0,I=C.hts.length;D<I;D+=1)S=C.hts[D],T=i(S,C.d),T.position.x=P-2*o,N.add(T),P-=S*(8+o);N.position.z=M,N.originalZ=M,x.add(N),M+=C.d+2*o}for(m in d)if(f=d[m],f.isBlockStart){if(b=g[f.compactBlockNum],!b.maxD)continue;var O=L(b.maxLeft),j=L(b.maxRight),A=new THREE.Shape([new THREE.Vector2(O+u*(8+o),0),new THREE.Vector2(j,0),new THREE.Vector2(j,b.maxD),new THREE.Vector2(O+u*(8+o),b.maxD)]),F=new THREE.ExtrudeGeometry(A,{bevelEnabled:!1,steps:1,amount:2}),V=new THREE.Mesh(F,H);V.rotation.x=Math.PI/2,V.position.y=1,V.visible=!1,f.add(V),f.hatchC=V}this.scene.add(x),x.position.y=1.5,this.hatchDeck=x}},{key:"_createShipDeck",value:function e(){var t=new THREE.LineBasicMaterial({color:4033704,opacity:1,linewidth:2}),i=this.appScene.options.extraSep,o=this.maxWidth,n=this.maxDepth,a=void 0,r=new THREE.CurvePath,s=void 0,l=void 0,d=o*(8+i)/4;r.add(new THREE.EllipseCurve(4,20,d,3*d,Math.PI,0,!1)),r.add(new THREE.EllipseCurve(4,n,d,.75*d,0,Math.PI,!1)),r.closePath(),s=r.createPointsGeometry(150),l=new THREE.Line(s,t),l.rotation.x=Math.PI/2,this.scene.add(l),this.simpleDeck=l}},{key:"_createHouse",value:function e(t){var i=this.appScene.options.extraSep,o=this.maxWidth,n=this.appScene.data.belowTiers,a=o*(8+i)/2*.9,r=Math.max(1,t)*(9.5+i)+6,s,l,d,c,u=Math.max(1,.7*n.n),h=u*(9.5+i),p=u*(8+i)/2,v,m=new THREE.MeshPhongMaterial({color:6075098,side:THREE.DoubleSide}),f=new THREE.MeshPhongMaterial({color:11184810,side:THREE.DoubleSide});l=new THREE.Shape([new THREE.Vector2(0,-h),new THREE.Vector2(-p,-h),new THREE.Vector2(-a,0),new THREE.Vector2(-a,r),new THREE.Vector2(-a-.25*a,r+10),new THREE.Vector2(-a-.25*a,r+20),new THREE.Vector2(-a,r+20),new THREE.Vector2(-a+.125*o,r+24),new THREE.Vector2(a-.125*o,r+24),new THREE.Vector2(a,r+20),new THREE.Vector2(a+.25*a,r+20),new THREE.Vector2(a+.25*a,r+10),new THREE.Vector2(a,r),new THREE.Vector2(a,0),new THREE.Vector2(p,-h),new THREE.Vector2(0,-h)]),s=new THREE.ExtrudeGeometry(l,{bevelEnabled:!1,steps:1,amount:20}),d=new THREE.Mesh(s,f),d.matrixAutoUpdate=!1,v=new THREE.Object3D,v.name="house",v.add(d),l=new THREE.Shape([new THREE.Vector2(-1.125*a,0),new THREE.Vector2(-1.125*a,7),new THREE.Vector2(1.125*a,7),new THREE.Vector2(1.125*a,0)]),c=new THREE.ShapeGeometry(l),d=new THREE.Mesh(c,m),d.position.y=r+10,d.position.z=-.25,d.matrixAutoUpdate=!1,d.updateMatrix(),v.add(d),d=new THREE.Mesh(c,m),d.position.y=r+10,d.position.z=20.25,d.matrixAutoUpdate=!1,d.updateMatrix(),v.add(d),c=new THREE.SphereGeometry(5,32,32),d=new THREE.Mesh(c,f),d.position.y=r+24,d.position.z=10,d.position.x=a-10,d.matrixAutoUpdate=!1,d.updateMatrix(),v.add(d),c=new THREE.SphereGeometry(5,32,32),d=new THREE.Mesh(c,f),d.position.y=r+24,d.position.z=10,d.position.x=-a+10,d.matrixAutoUpdate=!1,d.updateMatrix(),v.add(d),v.position.x=4,v.position.z=-20,v.visible=!1,this.scene.add(v),this.shipHouse={mesh:v,dropdown:null,currPosBay:0,currPosZ:0}}},{key:"setCameraPosition",value:function e(t,i,o){return this.camera.position.z=o,this.camera.position.x=t,this.camera.position.y=i,this.controls.maxDistance=2*o,this.controls.minDistance=o/2,{x:t,y:i,z:o}}},{key:"resize3DViewer",value:function e(t,i){this.camera&&(this.width=t,this.height=i,this.camera.aspect=t/i,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,i))}},{key:"loadModel",value:function e(t,i,o,n){var a=this,s=this.container,l=s.loadingDiv,d=this.appScene.options,c=void 0,u=void 0,h=void 0,p=void 0,v=void 0,m=void 0,f=void 0,y=function e(t){var i=t.loaded/(t.total||3e6);l.updateLoader(i,.3)},g=function e(t){var i=r.addEventDsptchr("modelLoaded");i.data={model:t},s.dispatchEvent(i),l.updateLoader(1,.5),setTimeout(function(){l.hide()},500)};return new Promise(function(e,t){var r=n.replace(".","_");return a._modelsLoaded[r]?void e(r):(l=a.container.loadingDiv,l.setPercentage(0),l.setMessage("Loading model..."),l.show(),m=new THREE.MTLLoader,m.setBaseUrl(i+"textures/"),m.setPath(i),void m.load(o,function(o){var s=void 0,l=void 0;o.preload(),f=new THREE.OBJLoader,f.setPath(i),f.setMaterials(o),f.load(n,function(t){var i=void 0,o=new THREE.Object3D;t.traverse(function(e){i=new THREE.Mesh(e.geometry,e.material),i.name=e.name,i.receiveShadow=!0,i.castShadow=!0,o.add(i)}),a._modelsLoaded[r]=o,g(),e(r)},y,function(e){window.alert("An error happened loading assets"),console.error(e),t()})}))})}},{key:"animate",value:function e(){function t(){requestAnimationFrame(t),i.controls.update(),i.render()}var i=this;t()}},{key:"render",value:function e(){var t=void 0,i=void 0,o=void 0,n=void 0,a=void 0;if(this._isRendering){if(this.frames+=1,1&this.frames)if(this.raycaster.setFromCamera(this.mouseVector.clone(),this.camera),t=this.raycaster.intersectObjects(this.containersGroup.children,!0),i=t.length,i>1){var r=this.appScene.data.containersIDs;o=t[1].object.name,null!==o&&void 0!==o&&(n=r[o],n&&t[1].object!==this._INTERSECTED&&(this._INTERSECTED&&(this._INTERSECTED.material=this._INTERSECTED.isBasic?this.basicMaterial:this.allMaterials[this._INTERSECTED.materialPos]),this._INTERSECTED=t[1].object,this._INTERSECTED.isBasic||(this._INTERSECTED.material=this.selectionMaterial),this.putInfoWindow(n)))}else this._INTERSECTED&&(this._INTERSECTED.material=this._INTERSECTED.isBasic?this.basicMaterial:this.allMaterials[this._INTERSECTED.materialPos],this._INTERSECTED=null);this.renderer.render(this.scene,this.camera)}}},{key:"putInfoWindow",value:function e(t){this.appScene._infoNode.innerHTML="<small>Position:</small> "+t.p+"<br /><small>ID:</small> "+t.c+"<br /><small>ISO:</small> "+t.i+(t.r?" / Reefer":"")+" <small>Status:</small> "+(t.s?"full":"empty")+"<br /><small>Carrier:</small> "+t.o+"<br /><small>POD:</small> "+t.d+"<br /><small>POL:</small> "+(t.f||"")+" <small>Weight:</small> "+t.m+"MT",this.appScene._bayNode.innerHTML="<small>bay</small> "+t.iBay}}]),e}();i.Renderer3D=d},{"../text2D/SpriteText2D.js":10,"../text2D/textAlign.js":11,"../utils/dom-utilities.js":12,"../utils/js-helpers.js":13}],7:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=e("../utils/js-helpers.js"),r=e("../utils/dom-utilities.js"),s=e("../utils/preloader.js"),l=e("./data-loader.js"),d=e("./models-factory.js"),c=e("./i18labels.js"),u=function(){function e(t){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];o(this,e);var n=this,s=1;this.options=a.extend({loaderColor:"#f2f2f2",loaderColorSucess:"#79e3da",sizes:[{name:"Letter",w:8.5,h:11},{name:"Legal",w:8.5,h:14},{name:"A4",w:8.3,h:11.7},{name:"A3",w:11.7,h:16.5}],dpis:[{name:"300 dpi",res:300},{name:"150 dpi",res:150}],extraSpace:{labelsTopHeight:8,labelsLeftWidth:7,extraOOGratio:.25},padding:{w:.04,h:11},aboveBelowSep:2},i),this._node=function(){var e=void 0,i=void 0,o=void 0,a=void 0,s=void 0,l=void 0,d=void 0,u=void 0,h=void 0,p=void 0,v=void 0,m=void 0,f=void 0,y=void 0,g=void 0,b=void 0,E=[],w=void 0,x=void 0,T="printopts-container-"+Math.round(1e5*Math.random());e=document.createElement("div"),e.className="printopts-container",e.id=T,i=document.createElement("div"),i.className="printopts-form",i.innerHTML="<h2>"+c.PRINTOPTS_TITLE+"</h2>",i.id=T+"-form",e.appendChild(i),o=document.createElement("div"),o.className="printopts-progress",o.id=T+"-progress",e.appendChild(o),w=document.createElement("div"),w.className="printopts-container-top",i.appendChild(w),a=document.createElement("SELECT"),a.id=T+"-dropdwn-orientation",w.appendChild(a),E=[],E.push("<option value='0'>"+c.PRINTOPTS_ORIENTATION_LANDSCAPE+"</option>"),E.push("<option value='1'>"+c.PRINTOPTS_ORIENTATION_PORTRAIT+"</option>"),a.innerHTML=E.join(""),l=document.createElement("SELECT"),l.id=T+"-dropdwn-dpi",w.appendChild(l),E=[];for(g in n.options.dpis)b=n.options.dpis[g],E.push("<option value='"+g+"'>"+b.name+"</option>");l.innerHTML=E.join(""),s=document.createElement("SELECT"),s.id=T+"-dropdwn-sizes",w.appendChild(s),E=[];for(g in n.options.sizes)b=n.options.sizes[g],E.push("<option value='"+g+"'>"+b.name+"</option>");return s.innerHTML=E.join(""),d=document.createElement("SELECT"),d.id=T+"-dropdwn-perrow",w.appendChild(d),u=document.createElement("SELECT"),u.id=T+"-dropdwn-colorby",w.appendChild(u),v=document.createElement("button"),v.innerHTML=c.PRINTOPTS_GO,v.className="save",i.appendChild(v),h=document.createElement("span"),h.innerHTML=" or ",i.appendChild(h),m=document.createElement("button"),m.innerHTML="CANCEL",i.appendChild(m),e.dropdwnOr=a,e.dropdwnSz=s,e.dropdwnDp=l,e.dropdwnRw=d,e.dropdwnClr=u,e.btnSave=v,e.btnCancel=m,e.divForm=i,e.divProgress=o,document.body.appendChild(e),t&&(r.addEventLnr(t,"click",n.toggleHandler.bind(n)),r.addEventLnr(a,"change",n.dropFilterChanged.bind(n)),r.addEventLnr(s,"change",n.dropFilterChanged.bind(n)),r.addEventLnr(l,"change",n.dropFilterChanged.bind(n)),r.addEventLnr(m,"click",n.close.bind(n)),r.addEventLnr(v,"click",n.launchPdfStart.bind(n))),e}(),this.title="",this.btnLaunch=t,this.width=0,this.height=0,this.inchFactor=0,this.lineWidth=1,this.baseUrl="",this.baseDownloadUrl="",this.data=null,this.dataLoader=new l.DataLoader(null),this.modelsFactory=null,this.onToggled=null,this.onSaved=null,this.postUrl=null,this._init()}return n(e,[{key:"loadUrl",value:function e(t,i,o){return this.dataLoader.loadUrl(t,i,o)}},{key:"loadData",value:function e(t){return this.dataLoader.generateStructuredData(t)}},{key:"_init",value:function e(){var t=this,i=void 0,o=void 0,n=void 0;this.modelsFactory=new d.ModelsFactory(this)}},{key:"dropFilterChanged",value:function e(){var t=this.options.dpis[this._node.dropdwnDp.value].res,i=this.options.sizes[this._node.dropdwnSz.value],o=void 0,n=void 0,a=void 0,r=void 0,s=this._node.dropdwnRw,l=this.options.padding.w,d=void 0;for(this.width=t*i["1"===this._node.dropdwnOr.value?"w":"h"],this.height=t*i["1"!==this._node.dropdwnOr.value?"w":"h"]-1,o=[],o.push("<option value='1'>"+c.PRINTOPTS_PERROW+": 1</option>"),n=2;n<9&&(r=Math.round(this.width/(n*(1+l))),!(r<.3*t));n+=1)o.push("<option data-w='"+r+"' value='"+n+"'>"+c.PRINTOPTS_PERROW+": "+n+"</option>");s.innerHTML=o.join(""),s.selectedIndex=Math.floor(o.length/2)}},{key:"applyColorsFilter",value:function e(t){var i=[],o=void 0,n=void 0;for(o in t)n=t[o],i.push("<option value='"+o+"'>"+c.PRINTOPTS_COLORBY+": "+n.name+"</option>");this._node.dropdwnClr.innerHTML=i.join("")}},{key:"toggleHandler",value:function e(t){this.toggle(!this.isOpened)}},{key:"close",value:function e(){this.toggle(!1)}},{key:"toggle",value:function e(){var t=arguments.length<=0||void 0===arguments[0]||arguments[0];return this._node.style.display=t?"block":"none",this.isOpened=t,t?(this._node.divForm.style.display="block",this._node.divProgress.style.display="none",this.dropFilterChanged(),void(this.onToggled&&this.onToggled(!0))):void(this.onToggled&&this.onToggled(!1))}},{key:"launchPdfStart",value:function e(){var t=this._node.dropdwnRw.value,i=this.options.dpis[this._node.dropdwnDp.value].res,o=this._node.dropdwnClr.value,n=this.width,a=this.height;this.pdfStart(t,i,n,a,o)}},{key:"pdfStart",value:function e(t,i,o,n,s,l){function d(e){var i=arguments.length<=1||void 0===arguments[1]?y.inchFactor:arguments[1],o=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],n=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],r=document.createElement("canvas"),l=void 0,d=void 0,c=void 0;if(r.width=I*i,r.height=D*i,l=r.getContext("2d"),o?(l.fillStyle="#ffffff",l.strokeStyle="#666666"):(d=b.filters[s].obs[e[s]].color,l.fillStyle=d,l.strokeStyle=a.lightenDarkenColor(d,-30)),l.lineWidth=2*y.lineWidth*i/y.inchFactor,l.rect(0,0,I*i,D*i),l.fill(),l.stroke(),n)return l.beginPath(),l.fillStyle="#666666",l.rect(I*i/9*4,D*i/9*3,I*i/9,D*i/9*3),l.fill(),l.rect(I*i/9*3,D*i/9*4,I*i/9*3,D*i/9),l.fill(),r;if(e.s||(c="e"),e.r&&(c="r"),c){var u=i/4;t<7&&(u+=.2*(8-t)),l.font=14*u+"px Arial",l.textAlign="center",l.fillStyle="#333333",l.fillText(c,4*i,7*i)}switch(e.w&&(l.strokeStyle="#666666",l.lineWidth=1,l.moveTo(0,D*i/2),l.lineTo(I*i/2,0),l.lineTo(I*i,D*i/2),l.lineTo(I*i/2,D*i),l.lineTo(0,D*i/2),l.stroke()),9.5===e.h&&(l.fillStyle="#333333",l.beginPath(),l.moveTo(I*i*3/4,0),l.lineTo(I*i,D*i/3),l.lineTo(I*i/2,D*i/3),l.lineTo(I*i*3/4,0),l.fill()),e.l){case 40:l.fillStyle="#333333",l.beginPath(),l.rect(0,0,I*i/2,1*i),l.fill();break;case 45:l.moveTo(0,0),l.fillStyle="#333333",l.beginPath(),l.arc(0,0,3*i,2*Math.PI,Math.PI),l.fill()}return r}function u(e){var t=arguments.length<=1||void 0===arguments[1]?y.inchFactor:arguments[1],i=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];return d(e,t,i,!0)}function h(e){var t=arguments.length<=1||void 0===arguments[1]?y.inchFactor:arguments[1],i=document.createElement("canvas"),o=void 0,n=void 0,a=void 0,r=e.g,s=I*t,l=D*t,d=D*ee*t,c=I*ee*t,u=s+2*d,h=l+2*c;return i.width=u,i.height=h,o=i.getContext("2d"),o.fillStyle="#444444",r.indexOf("t")>=0&&(o.beginPath(),o.ellipse(u/2,d,s/2,d,0,Math.PI,2*Math.PI),o.fill()),r.indexOf("l")>=0&&(o.beginPath(),o.ellipse(c,h/2,c,l/2,0,.5*Math.PI,1.5*Math.PI),o.fill()),r.indexOf("r")>=0&&(o.beginPath(),o.ellipse(c+s,h/2,c,l/2,0,1.5*Math.PI,.5*Math.PI),o.fill()),r.indexOf("f")>=0&&(o.beginPath(),o.moveTo(c,d+l/4),o.lineTo(c+s,d+l/4),o.stroke()),r.indexOf("b")>=0&&(o.beginPath(),o.moveTo(c,l+d-l/4),o.lineTo(c+s,l+d-l/4),o.stroke()),r.indexOf("x")>=0&&(o.beginPath(),o.moveTo(c,d),o.lineTo(u-c,h-d),o.moveTo(u-c,d),o.lineTo(c,h-d),o.stroke()),i}function p(e){var i=void 0,o=void 0,n=void 0,r=void 0,s=E[e],l=void 0,c=void 0,p=void 0,v=void 0,m=void 0,f=e,g=void 0,b=Math.round(I/2)*y.inchFactor,w=D*y.inchFactor,x=I*y.inchFactor,C=!0;c=document.createElement("canvas"),c.width=H,c.height=T*y.inchFactor+2*Y*y.inchFactor,p=c.getContext("2d"),s.isBlockStart&&s.maxD>20&&(f+=" ("+a.pad(Number(e)+1,3)+")"),s.isBlockStart||(l=E[a.pad(Number(e)-2,3)],l.maxD>20&&(f+=" ("+a.pad(Number(e)-1,3)+")")),g=de,t<7&&(g+=.2*(8-t)),p.font=24*g+"px Georgia",p.textAlign="center",p.textBaseline="top",p.fillText(f,H/2,Math.max(Y/2*y.inchFactor,.5*y.inchFactor)),p.font=10*g+"px Arial",p.textAlign="center",p.textBaseline="middle",p.fillStyle="#666666",p.strokeStyle="#dddddd",p.lineWidth=2*y.lineWidth,p.save(),console.log("Step 1, Bay "+e),m=Math.floor((_.max(V)+I+1.5*X)*y.inchFactor);for(i in z)v=(z[i]-D+Y)*y.inchFactor+(w+6)/2,p.fillText(a.pad(i,2),X/2*y.inchFactor,v),p.fillText(a.pad(i,2),m,v);for(n in V){m=(V[Number(n)]+X)*y.inchFactor,p.fillText(a.pad(n,2),b+m,(_.min(z)-.5*Y)*y.inchFactor),p.fillText(a.pad(n,2),b+m,(_.max(z)+1.5*Y)*y.inchFactor);for(i in z)v=(z[i]-D+Y)*y.inchFactor,p.rect(m,v,x,w),p.stroke()}for(n in s.cells){r=s.cells[n];for(i in r.tiers){m=(V[Number(n)]+X)*y.inchFactor,v=(z[Number(i)]-D+Y)*y.inchFactor;var S=d(r.tiers[i]);p.drawImage(S,m,v)}}for(n in s.cells){r=s.cells[n];for(i in r.tiers)if(r.tiers[i].g){m=(V[Number(n)]+X)*y.inchFactor,v=(z[Number(i)]-D+Y)*y.inchFactor;var S=h(r.tiers[i]);p.drawImage(S,m-ie,v-te)}}if(!s.isBlockStart&&(s=E[a.pad(Number(e)-2,3)]))for(n in s.cells){r=s.cells[n];for(i in r.tiers)if(!(1&r.tiers[i].iBay)){m=(V[Number(n)]+X)*y.inchFactor,v=(z[Number(i)]-D+Y)*y.inchFactor;var S=u(r.tiers[i]);p.drawImage(S,m,v)}}return c}function v(){function e(){n=document.createElement("canvas"),n.width=1.5*H,n.height=p,a=n.getContext("2d"),a.font=19*g+"px Arial",a.textAlign="left",a.fillStyle="#444444",r=c,l=u,_=0,R.push(n)}function i(t,i){var o=arguments.length<=2||void 0===arguments[2]||arguments[2];o&&(i[s]=""),0===P&&0===_&&e(),l=P*v+u,a.drawImage(d(i,y.inchFactor*E,o),r,l),i.g&&a.drawImage(h(i,y.inchFactor*E),r-x,l-w),a.fillText(t,r+14*y.inchFactor,l+8*y.inchFactor),f=Math.round(Math.max(f,a.measureText(t).width)),P+=1,P===M-1&&(l=u,r+=c+m+f,f=0,_+=1,_>1&&(_=0,r=c),P=0)}var o=void 0,n=void 0,a=void 0,r=0,l=0,c=Math.round(6*y.inchFactor),u=Math.round(Y*y.inchFactor*2),p=T*y.inchFactor+2*Y*y.inchFactor,v=Math.round(14*y.inchFactor),m=Math.round(18*y.inchFactor),f=0,g=void 0,E=1.25,w=Math.round(D*ee*y.inchFactor*E),x=Math.round(I*ee*y.inchFactor*E),C=void 0,S=void 0,R=[],_=0,P=0,M=0;g=de,t<7&&(g+=.2*(8-t)),t<4&&(E=1.2),M=Math.floor(p/v),P=0;for(o in b.filters[s].obs)S={s:1},S[s]=o,i(o,S,!1);return i("Hazardous",{s:1,w:1}),i("Empty",{s:0}),i("Reefer",{s:1,r:1}),i("High-cube",{s:1,h:9.5}),i("40-footer",{s:1,l:40}),i("45-footer",{s:1,l:45}),i("Break Bulk",{s:1,g:"x"}),i("Oversize Top",{s:1,g:"t"}),i("Oversize Left",{s:1,g:"l"}),i("Oversize Right",{s:1,g:"r"}),i("Oversize Front",{s:1,g:"f"}),i("Oversize Back",{s:1,g:"b"}),R}function m(){var e=y.postUrl,t=void 0,i=void 0,o=void 0,n=void 0,a=void 0,l=void 0,d=function e(t){if(t.lengthComputable){var i=Math.round(100*t.loaded/t.total);Q.innerHTML=t.loaded<t.total?i+"%":"Finishing, please wait..."}};for(o="0"===y._node.dropdwnOr.value,i={title:y.title,numImages:W.length,pageSize:y.options.sizes[y._node.dropdwnSz.value].name,pageSizeW:y.options.sizes[y._node.dropdwnSz.value][o?"h":"w"],pageSizeH:y.options.sizes[y._node.dropdwnSz.value][o?"w":"h"]-1,pageOrientation:o?"L":"P",filterBy:c.PRINTOPTS_COLORBY+": "+b.filters[s].name,vesselName:y.metaData.vesselName,vesselCallSign:y.metaData.vesselCallSign,sender:y.metaData.sender,recipient:y.metaData.recipient,placeOfDeparture:y.metaData.placeOfDeparture,voyageNumber:y.metaData.voyageNumber,footerLeft:y.metaData.footerLeft,footerRight:y.metaData.footerRight,locationUrl:y.baseUrl,downloadUrl:y.baseDownloadUrl},n=0,a=W.length;n<a;n+=1)i["page_"+n]=W[n].toDataURL("image/png");t=jQuery.ajax({url:e,type:"POST",data:i,timeout:72e5}),Q&&t.uploadProgress(d),t.fail(function(e){console.error(e),Q&&(Q.innerHTML="An error has ocurred.",l=document.createElement("button"),l.innerHTML="Close this window",r.addEventLnr(l,"click",y.close.bind(y)),Q.appendChild(l))}),t.done(function(e){console.log(e),e.download?(Q.innerHTML="<a href='"+e.download+"' target='_blank'>Download PDF</a><br /><br />",l=document.createElement("button"),l.innerHTML="Close this window",r.addEventLnr(l,"click",y.close.bind(y)),Q.appendChild(l)):Q.innerHTML="An error has ocurred."})}function f(){var e=void 0,t=void 0,i=void 0,o=[],n=void 0,r=void 0,s=void 0,l=void 0;for(e=0,t=w.length;e<t;e+=1)r=w[e],o.push(r),s=Number(r),n=E[r],i=e+1,(n.isBlockStart&&i<t&&Number(w[i])!==s+2||i===t)&&(l=a.pad(s+2,3),o.push(l),E[l]={n:0,maxD:n.maxD,isBlockStart:!1,cells:{},maxCell:n.maxCell});w=o}var y=this,g=this.options.aboveBelowSep,b=this.data,E=_.clone(b.dataStructured),w=_.clone(b.dataStructuredKeysArr),x=b.hasZeroCell,T=void 0,C=void 0,S=void 0,R=void 0,P=[0],M=[0],k=[],N=void 0,H=void 0,B=void 0,L=void 0,D=8,I=8,O=void 0,j=y.options.padding.w,A=void 0,F=void 0,V={},z={},U=0,W=[],G=void 0,Z=void 0,J=void 0,K=void 0,q=this._node.divForm,Q=this._node.divProgress,Y=this.options.extraSpace.labelsTopHeight,X=this.options.extraSpace.labelsLeftWidth,ee=this.options.extraSpace.extraOOGratio,te=void 0,ie=void 0,oe=void 0,ne=void 0,ae=void 0,re=void 0,se=void 0,le=void 0,de=1,ce=!0;for(f(),q&&(q.style.display="none"),Q&&(Q.style.display="block",Q.innerHTML=c.PRINTOPTS_PAGEPROGRESS),T=(b.belowTiers.n+b.aboveTiers.n)*D+2*g+2*Y,C=(b.maxWidth+(x?1:0))*I+2*X,H=Math.floor(o/(t*(1+j))),O=Math.floor(H*j),this.lineWidth=Math.round(i/300),this.inchFactor=H/C,de=i/300,N=Math.floor(H-2*X*y.inchFactor),te=D*ee*y.inchFactor,ie=I*ee*y.inchFactor,B=Math.floor((T+D)*y.inchFactor),L=Math.floor(B+y.options.padding.h*y.inchFactor),oe=H*t+O*(t-1),ae=Math.min(Math.floor(n/L),Math.ceil(w.length/t)),ne=Math.floor(ae*B+(ae-1)*y.options.padding.h*y.inchFactor),re=Math.round((n-ne)/2),se=Math.round((o-oe)/2),P[0]=0,M[0]=0,le=v(),k=[{x:0,y:0}],S=1,R=w.length+le.length;S<R;S+=1)M[S]=M[S-1],P[S]=P[S-1]+H+O,S%t===0&&(M[S]=M[S-1]+L,P[S]=0),M[S]+L>n&&(M[S]=0),k.push({x:P[S],y:M[S]});A=Number(_.max(E,function(e){return e.maxCell}).maxCell),F=(A+(x?1:0))*I;var ue=0,he=F-I;for(S=A,R=x?0:1;S>=R;S-=1)S%2===0?(V[S]=ue,ue+=I):(V[S]=he,he-=I);for(U=0,S=b.iTierMin,R=b.iTierMax;S<=R;S+=2)z[S]=T-U,U+=D;for(U+=2*g,S=b.iTierMinAbove,R=b.iTierMaxAbove;S<=R;S+=2)z[S]=T-U,U+=D;G=document.createElement("canvas"),G.width=o,G.height=n,Z=G.getContext("2d"),K=0,setTimeout(function(){for(var e=w.length,t=le||v(),i=t.length,a=void 0,r=0;r<e;r+=1){var s=w[r],l=void 0;s&&(0===k[r].x&&0===k[r].y&&(G=document.createElement("canvas"),G.width=o,G.height=n,Z=G.getContext("2d"),W.push(G)),l=p(w[r]),Z.drawImage(l,k[r].x+se,k[r].y+re))}for(var d=0;d<i;d+=1)a=e+d,0===k[a].x&&0===k[a].y&&(G=document.createElement("canvas"),G.width=o,G.height=n,Z=G.getContext("2d"),W.push(G)),Z.drawImage(t[d],Math.round(k[a].x+se),Math.round(k[a].y+re));Q.innerHTML=c.PRINTOPTS_SENDINGPAGES,m()},1e3),window.pagess=W}},{key:"setTitle",value:function e(t,i,o){var n=(t?t:"")+(i?" / "+i:"")+(o?" / "+o:"");n&&(this.title=n)}},{key:"setMetaData",value:function e(t,i,o,n,a,r,s,l){this.metaData={vesselName:t,vesselCallSign:i,sender:o,recipient:n,placeOfDeparture:a,voyageNumber:r,footerLeft:s,footerRight:l}}}]),e}();i.VesselsApp2D=u},{"../utils/dom-utilities.js":12,"../utils/js-helpers.js":13,"../utils/preloader.js":14,"./data-loader.js":3,"./i18labels.js":4,"./models-factory.js":5}],8:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=e("../utils/js-helpers.js"),r=e("../utils/dom-utilities.js"),s=e("../utils/preloader.js"),l=e("./renderer.js"),d=e("./data-loader.js"),c=e("./models-factory.js"),u=e("./i18labels.js"),h=function(){function e(t,i,n,r,l){o(this,e);var c=this,u=a.getQueryParams(),h=1.1;this.options=a.extend({extraSep:.5,loaderColor:"#f2f2f2",loaderColorSucess:"#79e3da",colors:{background:13823736,sunlight:14869230},dampingFactorOut:.2,dampingFactorIn:.75,initialCameraPosition:{x:0,y:0,z:100},labelScale:8,screenshots:{width:600,height:600,format:"png",transparent:!0}},l),this.width=0,this.height=0,this._titleNode=i,this._bayNode=r,this._infoNode=n,this._node=function e(){var i=void 0,o=void 0,n=void 0,a=void 0,r="app3d-container-"+Math.round(1e5*Math.random());return i=document.createElement("div"),i.className="app3d-container",i.id=r,o=document.createElement("div"),o.className="app3d-render-container",o.id=r+"-render",i.appendChild(o),i.divRenderC=o,n=document.getElementById("app-3d-loading-div"),n||(n=document.createElement("div"),n.className="app3d-loading-div",n.id=r+"-loading-div",i.appendChild(n)),a=document.getElementById("app-3d-loading-div-text"),
a||(a=document.createElement("div"),a.className="app3d-loading-div-text",a.id=r+"-loading-text",n.appendChild(a)),i.loadingDiv=new s(n,a,100,c.options,"img-loader-logo"),t.appendChild(i),i}(),this.initialBay=u.bay,this.data=null,this.dataLoader=new d.DataLoader(this._node.loadingDiv),this.renderer3d=null,this.modelsFactory=null,this._init()}return n(e,[{key:"loadUrl",value:function e(t,i,o){return this.dataLoader.loadUrl(t,i,o)}},{key:"loadData",value:function e(t){return this.dataLoader.generateStructuredData(t)}},{key:"_init",value:function e(){var t=this,i=void 0,o=void 0,n=void 0,a=this._node,s=Detector.canvas&&Detector.webgl;return s?(this.updateSize(),this.renderer3d=new l.Renderer3D(this,this.width,this.height),this.renderer3d.init(),this.renderer3d.animate(),this.modelsFactory=new c.ModelsFactory(this),void r.addEventLnr(window,"resize",function(){t.updateSize()})):(a.loadingDiv.show(),void a.loadingDiv.setMessage(a.parentNode.getAttribute(window.WebGLRenderingContext?"data-webgl":"data-gpu")))}},{key:"updateHtmlTitle",value:function e(t,i,o){var n=this,a=void 0;n._titleNode&&(a=(t?t:"")+(i?" / "+i:"")+(o?" / "+o:""),a?(n._titleNode.innerHTML=a,document.title=a+" / "+document.title):n._titleNode.style.display="none")}},{key:"getDimensions",value:function e(){return{width:this.width,height:this.height}}},{key:"_setDimensions",value:function e(t,i){this.width=t,this.height=i}},{key:"updateSize",value:function e(){var t=void 0,i=void 0,o=void 0,n=void 0,a=void 0,s=void 0;t=this._node,i=t.parentNode,null!==i&&void 0!==i&&(n=this.getDimensions(),a=i.offsetWidth,s=i.offsetHeight,n.width===a&&n.height===s||(t.style.width=a+"px",t.style.height=s+"px",this.renderer3d&&this.renderer3d.resize3DViewer(a,s),this._setDimensions(a,s),o=r.addEventDsptchr("resize"),this._node.dispatchEvent(o)))}},{key:"pauseRendering",value:function e(){this.renderer3d&&(this.renderer3d._isRendering=!1)}},{key:"resumeRendering",value:function e(){this.renderer3d&&(this.renderer3d._isRendering=!0)}},{key:"toggleRendering",value:function e(){var t=arguments.length<=0||void 0===arguments[0]||arguments[0];this.renderer3d&&(this.renderer3d._isRendering=!!t)}},{key:"generateScreenshot",value:function e(){var t=arguments.length<=0||void 0===arguments[0]?this.options.screenshots.width:arguments[0],i=arguments.length<=1||void 0===arguments[1]?this.options.screenshots.height:arguments[1],o=arguments.length<=2||void 0===arguments[2]?this.options.screenshots.format:arguments[2],n=arguments.length<=3||void 0===arguments[3]?this.options.screenshots.transparent:arguments[3];return data}}]),e}();i.VesselsApp3D=h},{"../utils/dom-utilities.js":12,"../utils/js-helpers.js":13,"../utils/preloader.js":14,"./data-loader.js":3,"./i18labels.js":4,"./models-factory.js":5,"./renderer.js":6}],9:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){var t=r[e];if(!t){var i=document.getElementsByTagName("body")[0],o=document.createElement("div"),n=document.createTextNode("span");o.appendChild(n),o.setAttribute("style","font:"+e+";position:absolute;top:0;left:0"),i.appendChild(o),t=o.offsetHeight,r[e]=t,i.removeChild(o)}return t}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),r={},s=function(){function e(){o(this,e),this.textWidth=null,this.textHeight=null,this.canvas=document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}return a(e,[{key:"drawText",value:function e(t,i){return this.ctx.font=i.font,this.textWidth=Math.ceil(this.ctx.measureText(t).width),this.textHeight=n(this.ctx.font),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle=i.fillStyle,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.font=i.font,this.ctx.fillStyle="#000",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(t,this.canvas.width/2,this.canvas.height/2),this.canvas}},{key:"width",get:function e(){return this.canvas.width}},{key:"height",get:function e(){return this.canvas.height}}]),e}();t.exports=s},{}],10:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),r=function e(t,i,o){for(var n=!0;n;){var a=t,r=i,s=o;n=!1,null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,r);if(void 0!==l){if("value"in l)return l.value;var d=l.get;if(void 0===d)return;return d.call(s)}var c=Object.getPrototypeOf(a);if(null===c)return;t=c,i=r,o=s,n=!0,l=c=void 0}},s=e("./textAlign.js"),l=e("./CanvasText.js"),d=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];o(this,t),r(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._font=i.font||"30px Arial",this._fillStyle=i.fillStyle||"#FFFFFF",this.canvas=new l,this.align=i.align||s.center,this.antialias=!0,this.text=e}return n(t,e),a(t,[{key:"updateText",value:function e(){this.canvas.drawText(this._text,{font:this._font,fillStyle:this._fillStyle}),this.cleanUp(),this.texture=new THREE.Texture(this.canvas.canvas),this.texture.needsUpdate=!0,this.applyAntiAlias(),this.material?this.material.map=this.texture:this.material=new THREE.SpriteMaterial({map:this.texture}),this.sprite||(this.sprite=new THREE.Sprite(this.material),this.geometry=this.sprite.geometry,this.add(this.sprite))}},{key:"cleanUp",value:function e(){this.texture&&this.texture.dispose()}},{key:"applyAntiAlias",value:function e(){this.antialias===!1&&(this.texture.magFilter=THREE.NearestFilter,this.texture.minFilter=THREE.LinearMipMapLinearFilter)}},{key:"width",get:function e(){return this.canvas.textWidth}},{key:"height",get:function e(){return this.canvas.textHeight}},{key:"text",get:function e(){return this._text},set:function e(t){this._text!==t&&(this._text=t,this.updateText())}},{key:"font",get:function e(){return this._font},set:function e(t){this._font!==t&&(this._font=t,this.updateText())}},{key:"fillStyle",get:function e(){return this._fillStyle},set:function e(t){this._fillStyle!==t&&(this._fillStyle=t,this.updateText())}}]),t}(THREE.Object3D);t.exports=d},{"./CanvasText.js":9,"./textAlign.js":11}],11:[function(e,t,i){"use strict";t.exports={center:new THREE.Vector2(0,0),left:new THREE.Vector2(1,0),topLeft:new THREE.Vector2(1,-1),topRight:new THREE.Vector2(-1,-1),right:new THREE.Vector2(-1,0),bottomLeft:new THREE.Vector2(1,1),bottomRight:new THREE.Vector2(-1,1)}},{}],12:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function e(t){return t&&t.tagName&&("textarea"===t.tagName.toLowerCase()||"input"===t.tagName.toLowerCase()&&"text"===t.type.toLowerCase())};i.isInputOrTextarea=o;var n=function e(t){return"object"==typeof HTMLElement?id instanceof HTMLElement:"object"==typeof id&&1===id.nodeType&&"string"==typeof id.nodeName};i.isHtmlNode=n;var a=function e(t,i,o){window.attachEvent?(t["e"+i+o]=o,t[i+o]=function(){t["e"+i+o](window.event)},t.attachEvent("on"+i,t[i+o])):t.addEventListener(i,o,!1)};i.addEventLnr=a;var r=function e(t){if(window.Event&&"function"==typeof window.Event)return new Event(t);var i=document.createEvent("Event");return i.initEvent(t,!0,!0),i};i.addEventDsptchr=r},{}],13:[function(e,t,i){"use strict";function o(e,t,i){e?t.apply(null,arguments):i.apply(null,arguments)}function n(e,t){var i=!1;"#"==e[0]&&(e=e.slice(1),i=!0);var o=parseInt(e,16),n=(o>>16)+t;n>255?n=255:n<0&&(n=0);var a=(o>>8&255)+t;a>255?a=255:a<0&&(a=0);var r=(255&o)+t;return r>255?r=255:r<0&&(r=0),(i?"#":"")+(r|a<<8|n<<16).toString(16)}Object.defineProperty(i,"__esModule",{value:!0}),i.callOnCondition=o,i.lightenDarkenColor=n;var a=function e(t){return Array.isArray?Array.isArray(t):t instanceof Array};i.isArray=a;var r=function e(t,i){var o=void 0,n=JSON.parse(JSON.stringify(t));if(i)for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&Object.prototype.hasOwnProperty.call(n,o)&&(n[o]=i[o]);return n};i.extend=r;var s=function e(t,i){return t-i};i.sortNumeric=s;var l=function e(t){var i=arguments.length<=1||void 0===arguments[1]||arguments[1],o=arguments.length<=2||void 0===arguments[2]||arguments[2],n=t;return i&&(n=n.replace(/^\s\s*/,"")),o&&(n=n.replace(/\s\s*$/,"")),n};i.trimString=l;var d=function e(t){var i=void 0,o=void 0,n=new Set;for(i=0,o=t.length;i<o;i+=1){var a=l(t[i]);n.has(a)||n.add(a)}return ouputSet};i.arrayToSet=d;var c=function e(t,i){var o=void 0,n=[];for(o in t)n.push(o);return i&&(n=n.sort(s)),n};i.objKeysToArray=c;var u=function e(t){var i=Number(t).toString(16);return i="000000".substr(0,6-i.length)+i,i.toUpperCase()};i.decimalToHex=u;var h=function e(t,i){var o="000"+String(t);return o.substr(o.length-i)};i.pad=h;var p=function e(){for(var t=document.location.search.split("+").join(" "),i={},o=void 0,n=/[?&]?([^=]+)=([^&]*)/g;o=n.exec(t);)i[decodeURIComponent(o[1])]=decodeURIComponent(o[2]);return i};i.getQueryParams=p},{}],14:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=function(){function e(t,i,n,a,r,s){void 0===t&&(t=mandatory()),o(this,e);var l=void 0;null!==t&&void 0!==t&&(this.node=t,l=document.createElement("canvas"),this.messages=i,this.canv=l,this.ctx=l.getContext("2d"),this.loadCurrent=0,this.radius=n,this.canv.width=Math.round(2*n),this.canv.height=Math.round(2*n),this.setPixelRatio(),this.opts=a,this.node.appendChild(l),this.image=r?document.getElementById(r):null,s&&this.setMessage(s))}return n(e,[{key:"rectLoader",value:function e(){var t=this.loadCurrent,i=this.ctx,o=this.radius,n=2*o,a=Math.round(o/2),r=2*t*Math.PI,s=this.opts;i.clearRect(0,0,n,n),i.beginPath(),i.arc(o,o,a,0,2*Math.PI,!1),i.fillStyle=s.loaderColor,i.fill(),i.lineWidth=1,i.strokeStyle=s.loaderColor,i.stroke(),i.beginPath(),i.arc(o,o,Math.round(a/2),0,r,!1),i.lineWidth=a,i.strokeStyle=s.loaderColorSucess,i.stroke(),this.image&&i.drawImage(this.image,a,a,o,o)}},{key:"setPixelRatio",value:function e(){var t=void 0,i=void 0,o=this.ctx,n=window.devicePixelRatio||1,a=o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1,r=n/a;n!==a&&(t=this.canv.width,i=this.canv.height,this.canv.width=t*r,this.canv.height=i*r,this.canv.style.width=t+"px",this.canv.style.height=i+"px",this.ctx.scale(r,r))}},{key:"setMessage",value:function e(t){var i=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];this.messages&&(this.messages.innerHTML=t,this.messages.style.color=i?"red":"")}},{key:"updateLoader",value:function e(t,i){var o=this;o.node&&TweenLite.to(o,i,{loadCurrent:t,ease:Power1.easeInOut,onUpdate:o.rectLoader,onUpdateScope:o})}},{key:"startAnimation",value:function e(){this.node&&(this.rectLoader(),this.updateLoader(.4,2))}},{key:"stopAnimation",value:function e(){this.node&&this.updateLoader(1,.25)}},{key:"setPercentage",value:function e(t){this.node&&(this.loadCurrent=t,this.rectLoader())}},{key:"show",value:function e(){this.node&&(this.node.style.display="block")}},{key:"hide",value:function e(){this.node&&(this.node.style.display="none")}}],[{key:"mandatory",value:function e(){throw new Error("Missing parameter")}}]),e}();i.default=a,t.exports=i.default},{}],15:[function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=function(){function e(){o(this,e),this.hue=Math.random(),this.goldenRatio=.618033988749895,this.hexwidth=2}return n(e,[{key:"hsvToRgb",value:function e(t,i,o){var n=Math.floor(6*t),a=6*t-n,r=o*(1-i),s=o*(1-a*i),l=o*(1-(1-a)*i),d=255,c=255,u=255;switch(n){case 0:d=o,c=l,u=r;break;case 1:d=s,c=o,u=r;break;case 2:d=r,c=o,u=l;break;case 3:d=r,c=s,u=o;break;case 4:d=l,c=r,u=o;break;case 5:d=o,c=r,u=s}return[Math.floor(256*d),Math.floor(256*c),Math.floor(256*u)]}},{key:"padHex",value:function e(t){return t.length>this.hexwidth?t:new Array(this.hexwidth-t.length+1).join("0")+t}},{key:"get",value:function e(t,i,o){this.hue+=this.goldenRatio,this.hue%=1,"number"!=typeof i&&(i=.5),"number"!=typeof o&&(o=.95);var n=this.hsvToRgb(this.hue,i,o);return t?"#"+this.padHex(n[0].toString(16))+this.padHex(n[1].toString(16))+this.padHex(n[2].toString(16)):n}}]),e}();i.RColor=a},{}]},{},[1]);